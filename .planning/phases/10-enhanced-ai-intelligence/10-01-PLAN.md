# Plan 10-01: Enhanced Entity Extraction with Calibrated Confidence

## Overview
Enhance the existing entity extraction with calibrated confidence scoring, multi-source weighting, and quality gates.

## Dependencies
- Existing: `services/graphrag/relationship-discovery.ts` (has basic confidence)
- Existing: `types/entity.types.ts` (CachedEntity schema)

## Tasks

### 1. Create entity confidence calibration module
Create `apps/omnii_mcp/src/services/ai/entity-confidence.ts`:
- Multi-source weight factors (calendar: 0.95, contact: 0.9, email: 0.85, note: 0.8, file: 0.75)
- Temporal proximity boost (recent = higher confidence)
- Graph relationship strength factor (more connections = higher confidence)
- Type-specific thresholds (Person: 0.7, Organization: 0.6, Date: 0.9, Location: 0.65)

### 2. Create entity extraction enhancer
Create `apps/omnii_mcp/src/services/ai/entity-extractor.ts`:
- Wrap existing LLM extraction with calibration layer
- Add entity disambiguation using graph lookup
- Return ExtractedEntity with calibrated confidence
- Support batch extraction for performance

### 3. Create entity quality gate
Create `apps/omnii_mcp/src/services/ai/entity-quality-gate.ts`:
- High confidence (>= 0.85): Auto-accept
- Medium confidence (0.6-0.85): Accept with flag
- Low confidence (< 0.6): Queue for review
- Export functions: `classifyConfidence()`, `shouldAutoAccept()`, `needsReview()`

### 4. Create entity types
Create `apps/omnii_mcp/src/services/ai/types.ts`:
- EnhancedEntity interface with calibrated confidence
- ConfidenceFactors interface
- ExtractionSource enum
- QualityClassification type

### 5. Create barrel export
Create `apps/omnii_mcp/src/services/ai/index.ts`

## Acceptance Criteria
- [ ] Entity extraction returns confidence scores 0.0-1.0
- [ ] Confidence varies by source type
- [ ] Quality gate classifies entities correctly
- [ ] Graph lookup improves disambiguation

## Wave
1 (no dependencies within phase)
